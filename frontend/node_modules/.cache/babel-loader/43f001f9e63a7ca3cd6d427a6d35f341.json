{"remainingRequest":"C:\\University\\SoftDevTech\\Salary\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\University\\SoftDevTech\\Salary\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\University\\SoftDevTech\\Salary\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\University\\SoftDevTech\\Salary\\frontend\\src\\views\\Profile.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\University\\SoftDevTech\\Salary\\frontend\\src\\views\\Profile.vue","mtime":1637430430836},{"path":"C:\\University\\SoftDevTech\\Salary\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\University\\SoftDevTech\\Salary\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\University\\SoftDevTech\\Salary\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\University\\SoftDevTech\\Salary\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport UserService from \"../services/user.service\";\nimport Menu from \"@/views/components/Menu\";\nimport Header from \"@/views/components/Header\";\nimport DatePicker from 'vue2-datepicker';\nimport 'vue2-datepicker/index.css';\nimport 'vue2-datepicker/locale/es/ru.js';\nexport default {\n  name: 'Profile',\n  data: function data() {\n    return {\n      message: '',\n      user: {\n        id: '',\n        email: '',\n        firstName: '',\n        lastName: '',\n        patronymic: '',\n        birthday: new Date(),\n        gender: false,\n        profilePicture: '',\n        workerInfo: {\n          maritalStatus: 0,\n          children: 0\n        }\n      },\n      selectedProfilePicture: null,\n      selectFocus: false,\n      passwordFocus: false,\n      oldPassword: '',\n      newPassword: '',\n      checkedPassword: '',\n      response: '',\n      lang: {\n        formatLocale: {\n          months: ['января', 'февраля', 'марта', 'апреля', 'мая', 'июня', 'июля', 'августа', 'сентября', 'октября', 'ноября', 'декабря']\n        }\n      }\n    };\n  },\n  components: {\n    DatePicker: DatePicker,\n    'v-menu': Menu,\n    'v-header': Header\n  },\n  computed: {\n    currentUser: function currentUser() {\n      return this.$store.state.auth.user;\n    },\n    isUserAdmin: function isUserAdmin() {\n      if (this.currentUser && this.currentUser.roles) {\n        return this.currentUser.roles.includes('ROLE_ADMIN');\n      }\n\n      return false;\n    },\n    isUserAccountant: function isUserAccountant() {\n      if (this.currentUser && this.currentUser.roles) {\n        return this.currentUser.roles.includes('ROLE_ACCOUNTANT');\n      }\n\n      return false;\n    },\n    hasRole: function hasRole() {\n      if (this.currentUser.roles.includes('ROLE_ADMIN')) return 'Администратор';\n      if (this.currentUser.roles.includes('ROLE_ACCOUNTANT')) return 'Бухгалтер';\n      if (this.currentUser.roles.includes('ROLE_USER')) return 'Сотрудник';\n      return 0;\n    },\n    maritalStatus: function maritalStatus() {\n      return [this.user.gender ? 'Не замужем' : 'Не женат', this.user.gender ? 'Замужем' : 'Женат', this.user.gender ? 'Разведена' : 'Разведен'];\n    },\n    notSamePasswords: function notSamePasswords() {\n      if (this.newPassword !== '' && this.checkedPassword !== '') {\n        return this.newPassword !== this.checkedPassword;\n      } else {\n        return false;\n      }\n    }\n  },\n  methods: {\n    onImageSelected: function onImageSelected(event) {\n      var _this = this;\n\n      var formData = new FormData();\n      var file = event.target.files[0];\n      formData.append(\"profilePicture\", file, file.name);\n      UserService.uploadProfilePicture(this.currentUser.id, formData).then(function (response) {\n        _this.user.profilePicture = response.data.profilePicture;\n      }, function (error) {\n        // eslint-disable-next-line no-console\n        console.log(error);\n      });\n    },\n    deactivatePasswordFocus: function deactivatePasswordFocus() {\n      this.passwordFocus = false;\n    },\n    deactivateSelectFocus: function deactivateSelectFocus() {\n      this.selectFocus = false;\n    },\n    changePassword: function changePassword() {\n      var _this2 = this;\n\n      this.passwordFocus = true;\n\n      if (!this.notSamePasswords && this.newPassword !== '' && this.checkedPassword !== '') {\n        this.$validator.validate().then(function (isValid) {\n          if (isValid && !_this2.newPassword.includes(' ')) {\n            UserService.changePassword(_this2.currentUser.id, _this2.oldPassword, _this2.newPassword).then(function (response) {\n              if (response.data) {\n                _this2.response = 'Пароль был успешно изменен';\n              } else {\n                _this2.response = \"Неверный старый пароль пароль\";\n              }\n            });\n          }\n        });\n      } else this.response = 'Заполните все поля';\n    },\n    changeUser: function changeUser() {\n      var _this3 = this;\n\n      UserService.changeUser(this.currentUser.id, this.user).then(function (response) {\n        response.data;\n      }, function (error) {\n        _this3.message = error.response && error.response.data && error.response.data.message || error.message || error.toString();\n      });\n    },\n    logOut: function logOut() {\n      this.$store.dispatch('auth/logout');\n      this.$router.push('/login');\n    }\n  },\n  mounted: function mounted() {\n    var _this4 = this;\n\n    if (!this.currentUser) {\n      this.$router.push('/login');\n    }\n\n    UserService.getUser(this.currentUser.id).then(function (response) {\n      _this4.user = response.data;\n      _this4.user.birthday = new Date(response.data.birthday);\n    }, function (error) {\n      _this4.message = error.response && error.response.data && error.response.data.message || error.message || error.toString();\n    });\n  }\n};",{"version":3,"sources":["Profile.vue"],"names":[],"mappings":"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","sourcesContent":["<style scoped>\n.mx-datepicker{\n  width: fit-content;\n}\n.alert-error{\n  text-align: left;\n  padding-left: 15px;\n}\n</style>\n<template>\n  <div v-if=\"currentUser\"><v-header\n      v-bind:user=\"{\n        firstName: user.firstName,\n        profilePicture: user.profilePicture,\n        gender: user.gender\n      }\"></v-header>\n  <div class=\"container\">\n\n\n    <v-menu></v-menu>\n\n    <div class=\"content\" style=\"max-width: 200px;\">\n      <div style=\"position: relative\">\n        <input\n            class=\"image-picker\"\n            type=\"file\"\n            accept=\"image/*\"\n            @change=\"onImageSelected\"\n        />\n        <img class=\"profile-picture\"\n             :src=\"user.profilePicture ?\n           require('../../public/images/store/'+user.profilePicture) :\n           require('../../public/images/default'+(user.gender ? 'Woman':'Man')+'.png')\" alt=\"profile picture\"/>\n      </div>\n\n\n      <div class=\"row\" style=\"background-color: #dfe6ed; margin-bottom: 0; padding: 5px; border-radius: 3px; justify-content: center;\">\n        {{hasRole}}\n      </div>\n      <div v-if=\"message\" class=\"row\" style=\"margin-bottom: 0; word-break:break-all ;color: #ff6464; justify-content: center\">{{message}}</div>\n    </div>\n    <div class=\"content\" style=\"width: calc(80% - 15% - 285px)\">\n      <div>\n        <div class=\"row\" style=\"margin: 0 15px\">\n          <input class=\"username\" type=\"text\" maxlength=\"30\" v-autowidth=\"{maxWidth: '700px', minWidth: '20px', comfortZone: 0}\" v-model=\"user.lastName\" @change=\"changeUser\">\n          <input class=\"username\" type=\"text\" maxlength=\"30\" v-autowidth=\"{maxWidth: '700px', minWidth: '20px', comfortZone: 0}\" v-model=\"user.firstName\" @change=\"changeUser\">\n          <input class=\"username\" type=\"text\" maxlength=\"30\" v-autowidth=\"{maxWidth: '700px', minWidth: '20px', comfortZone: 0}\" v-model=\"user.patronymic\" @change=\"changeUser\">\n        </div>\n        <div class=\"separator\"></div>\n        <div class=\"row\">\n          <div class=\"column\">\n            <div class=\"row user-info\">Почта:</div>\n            <div class=\"row user-info\">День рождения:</div>\n            <div class=\"row user-info\">Пол:</div>\n          </div>\n          <div class=\"column\">\n            <div class=\"row\">{{user.email}}</div>\n            <div class=\"row\">\n              <date-picker v-model=\"user.birthday\"\n                           @change=\"changeUser\"\n                         type=\"date\"\n                         format=\"DD MMMM YYYY г.\" :lang=\"lang\"\n                         :clearable = \"false\"\n                         :confirm=\"true\"\n                         input-class=\"date-picker\"\n                         placeholder=\"Выбрать\">\n              </date-picker>\n            </div>\n            <div class=\"row\" style=\"margin: calc(15px - 5px) 0; text-align: center;\">\n              <span v-bind:style=\"[user.gender ? {'background': 'none'} : {'background': 'rgb(223, 230, 237)'}]\"\n                    @click=\"user.gender=false; changeUser()\"\n                    class=\"material-icons square-border-button\">\n                man\n              </span>\n              <div style=\"width: 100%;\">{{user.gender ? 'Женский' : 'Мужской'}}</div>\n              <span v-bind:style=\"[user.gender ? {'background': 'rgb(223, 230, 237)'} : {'background': 'none'}]\"\n                    @click=\"user.gender=true; changeUser()\"\n                    class=\"material-icons square-border-button\">\n                woman\n              </span>\n            </div>\n          </div>\n        </div>\n        <div class=\"separator\"></div>\n        <div v-if=\"user.workerInfo\">\n          <div class=\"row\">\n            <div class=\"column\">\n              <div class=\"row user-info\">Семейное положение:</div>\n              <div class=\"row user-info\">Количество детей:</div>\n            </div>\n            <div class=\"column\">\n              <div class=\"row\">\n                <div v-click-outside=\"deactivateSelectFocus\" style=\"position: relative; width: fit-content; min-width: 6em; padding-right: 20px\">\n                  <div @click=\"selectFocus=!selectFocus\" style=\"display: flex; justify-content: space-between;\">\n                    <div style=\"margin-right: 5px\">{{maritalStatus[user.workerInfo ? (user.workerInfo.maritalStatus % 3):0]}}</div>\n                    <span class=\"material-icons\" v-bind:style=\"{ 'padding-right': '0px', transform: 'rotate('+ (selectFocus ? '90':'0')+'deg)'}\">chevron_right</span>\n                  </div>\n                  <div class=\"select\" v-bind:style=\"[selectFocus ? {display:'block'} : {display: 'none'}]\">\n                    <div @click=\"selectFocus=!selectFocus\">Placeholder</div>\n                    <div v-for=\"(status, index) in maritalStatus\" :key=\"index\"\n                         @click=\"()=>{user.workerInfo.maritalStatus=index; deactivateSelectFocus(); changeUser()}\">\n                      {{status}}\n                    </div>\n                  </div>\n\n                </div>\n              </div>\n              <div class=\"row\" style=\"padding-right: 20px\">\n                <div><span\n                    style=\"display: block; background-color: rgb(223, 230, 237); border-radius: 3px; padding: 0; cursor: pointer\"\n                    @click=\"()=>{if(user.workerInfo.children > 0) {user.workerInfo.children-=1; changeUser()}}\"\n                    class=\"material-icons unselectable\">remove</span>\n                </div>\n                <div style=\"padding: 0 10px; width: 100%; text-align: center\">{{user.workerInfo.children}}</div>\n                <div><span\n                    style=\"display: block; background-color: rgb(223, 230, 237); border-radius: 3px; padding: 0; cursor: pointer\"\n                    @click=\"()=>{if(user.workerInfo.children < 10) {user.workerInfo.children+=1; changeUser()}}\"\n                    class=\"material-icons unselectable\">add</span>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"separator\"></div>\n        </div>\n        <div v-click-outside=\"deactivatePasswordFocus\" v-bind:class=\"[passwordFocus ? 'active-block' : '', 'column']\">\n\n          <div v-if=\"response && passwordFocus\" class=\"alert-error\">{{response}}</div>\n          <div class=\"row\">\n            <div class=\"user-info\">Старый пароль:</div>\n            <input type=\"password\"\n                   class=\"border-input\"\n                   v-on:focus=\"passwordFocus = true\"\n                   v-model=\"oldPassword\"/>\n          </div>\n          <div class=\"row\">\n            <div class=\"user-info\">Новый пароль:</div>\n            <input type=\"password\"\n                   class=\"border-input\"\n                   v-on:focus=\"passwordFocus = true\"\n                   v-model=\"newPassword\" name=\"пароль\"\n                   v-validate=\"'required|min:6|max:40'\"/>\n          </div>\n          <div class=\"alert-error\" v-if=\"this.newPassword.includes(' ') && passwordFocus\">Пароль не может содержать пробелы</div>\n          <div\n              v-else-if=\"errors.has('пароль') && passwordFocus\"\n              class=\"alert-error\">\n            {{errors.first('пароль')}}\n          </div>\n          <div class=\"row\">\n            <div class=\"user-info\">Повторите новый пароль:</div>\n            <input type=\"password\"\n                   class=\"border-input\"\n                   v-on:focus=\"passwordFocus = true\"\n                   v-model=\"checkedPassword\"/>\n          </div>\n          <div v-if=\"notSamePasswords && passwordFocus\" class=\"alert-error\">Пароли не совпадают</div>\n          <div class=\"row\">\n            <div class=\"user-info\"></div>\n            <div class=\"btn btn-thin\" style=\"margin: 0\" @click=\"changePassword\">Сменить пароль</div>\n          </div>\n\n        </div>\n        <div class=\"separator\"></div>\n      </div>\n      <div class=\"row\">\n        <button class=\"btn\" style=\"margin: 15px\" @click.prevent=\"logOut\">\n          Выйти\n        </button>\n      </div>\n\n        <!-- END -->\n\n      </div>\n  </div>\n  </div>\n</template>\n\n<script>\nimport UserService from '../services/user.service';\nimport Menu from \"@/views/components/Menu\";\nimport Header from \"@/views/components/Header\";\n\nimport DatePicker from 'vue2-datepicker';\nimport 'vue2-datepicker/index.css';\nimport 'vue2-datepicker/locale/es/ru.js';\n\nexport default {\n  name: 'Profile',\n  data(){\n    return{\n      message: '',\n      user:{\n        id:'',\n        email:'',\n        firstName:'',\n        lastName:'',\n        patronymic: '',\n        birthday: new Date(),\n        gender: false,\n        profilePicture: '',\n\n        workerInfo:{\n          maritalStatus: 0,\n          children: 0\n        }\n      },\n\n      selectedProfilePicture: null,\n\n      selectFocus: false,\n      passwordFocus: false,\n\n      oldPassword: '',\n      newPassword: '',\n      checkedPassword: '',\n      response: '',\n\n      lang: {\n        formatLocale: {\n          months: ['января', 'февраля', 'марта', 'апреля', 'мая', 'июня', 'июля', 'августа', 'сентября', 'октября', 'ноября', 'декабря'],\n        }\n      },\n    };\n  },\n  components:{\n    DatePicker,\n    'v-menu' : Menu,\n    'v-header': Header\n  },\n  computed: {\n    currentUser() {\n      return this.$store.state.auth.user;\n    },\n    isUserAdmin() {\n      if (this.currentUser && this.currentUser.roles) {\n        return this.currentUser.roles.includes('ROLE_ADMIN');\n      }\n\n      return false;\n    },\n    isUserAccountant() {\n      if (this.currentUser && this.currentUser.roles) {\n        return this.currentUser.roles.includes('ROLE_ACCOUNTANT');\n      }\n\n      return false;\n    },\n    hasRole(){\n      if (this.currentUser.roles.includes('ROLE_ADMIN')) return 'Администратор';\n      if (this.currentUser.roles.includes('ROLE_ACCOUNTANT')) return 'Бухгалтер';\n      if (this.currentUser.roles.includes('ROLE_USER')) return 'Сотрудник';\n      return 0;\n\n    },\n    maritalStatus(){\n      return [\n        this.user.gender ? 'Не замужем': 'Не женат',\n        this.user.gender ? 'Замужем': 'Женат',\n        this.user.gender ? 'Разведена': 'Разведен'\n      ]\n    },\n\n\n    notSamePasswords () {\n      if (this.newPassword !== '' && this.checkedPassword !== '') {\n        return (this.newPassword !== this.checkedPassword)\n      } else {\n        return false\n      }\n    },\n  },\n\n  methods: {\n    onImageSelected(event) {\n      let formData = new FormData();\n      let file = event.target.files[0];\n      formData.append(\"profilePicture\", file, file.name);\n      UserService.uploadProfilePicture(this.currentUser.id, formData).then(\n          response => {\n            this.user.profilePicture = response.data.profilePicture;\n          },\n          error => {\n            // eslint-disable-next-line no-console\n            console.log(error);\n          }\n      );\n    },\n\n    deactivatePasswordFocus(){\n      this.passwordFocus=false;\n    },\n    deactivateSelectFocus(){\n      this.selectFocus=false;\n    },\n    changePassword(){\n      this.passwordFocus = true;\n      if (!this.notSamePasswords && this.newPassword !== '' && this.checkedPassword !== ''){\n        this.$validator.validate().then(isValid => {\n          if (isValid && !this.newPassword.includes(' ')) {\n            UserService.changePassword(this.currentUser.id,this.oldPassword,this.newPassword).then(\n                response => {\n                  if (response.data){\n                    this.response = 'Пароль был успешно изменен';\n                  } else {\n                    this.response = \"Неверный старый пароль пароль\";\n                  }\n                }\n            );\n          }\n        });\n      } else this.response = 'Заполните все поля'\n    },\n    changeUser(){\n      UserService.changeUser(this.currentUser.id, this.user).then(\n          response => {\n            response.data;\n          },\n          error => {\n            this.message =\n                (error.response && error.response.data && error.response.data.message) ||\n                error.message ||\n                error.toString();\n          }\n      );\n    },\n    logOut() {\n      this.$store.dispatch('auth/logout');\n      this.$router.push('/login');\n    }\n  },\n  mounted() {\n    if (!this.currentUser) {\n      this.$router.push('/login');\n    }\n    UserService.getUser(this.currentUser.id).then(\n        response => {\n          this.user = response.data;\n          this.user.birthday = new Date(response.data.birthday);\n        },\n        error => {\n          this.message =\n              (error.response && error.response.data && error.response.data.message) ||\n              error.message ||\n              error.toString();\n        }\n    );\n\n\n  }\n};\n</script>"],"sourceRoot":"src/views"}]}