{"remainingRequest":"C:\\University\\SoftDevTech\\Salary\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\University\\SoftDevTech\\Salary\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\University\\SoftDevTech\\Salary\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\University\\SoftDevTech\\Salary\\frontend\\src\\views\\components\\userEditor.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\University\\SoftDevTech\\Salary\\frontend\\src\\views\\components\\userEditor.vue","mtime":1638119093752},{"path":"C:\\University\\SoftDevTech\\Salary\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\University\\SoftDevTech\\Salary\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\University\\SoftDevTech\\Salary\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\University\\SoftDevTech\\Salary\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.string.starts-with\";\nimport \"core-js/modules/es6.array.find\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport DatePicker from 'vue2-datepicker';\nimport 'vue2-datepicker/index.css';\nimport 'vue2-datepicker/locale/es/ru.js';\nimport UserService from \"@/services/user.service\";\nexport default {\n  name: \"userEditor\",\n  props: ['userToEdit', 'success', 'close'],\n  data: function data() {\n    return {\n      message: '',\n      newPassword: '',\n      checkedPassword: '',\n      successful: false,\n      selectFocus: false,\n      positionFocus: false,\n      selectedPosition: '',\n      positions: [],\n      user: {\n        id: '',\n        email: '',\n        password: '',\n        firstName: '',\n        lastName: '',\n        patronymic: '',\n        birthday: '',\n        gender: false,\n        profilePicture: '',\n        workerInfo: {\n          position: {},\n          maritalStatus: 0,\n          children: 0\n        },\n        roles: [{\n          id: 1,\n          name: 'ROLE_USER'\n        }]\n      },\n      lang: {\n        formatLocale: {\n          months: ['января', 'февраля', 'марта', 'апреля', 'мая', 'июня', 'июля', 'августа', 'сентября', 'октября', 'ноября', 'декабря']\n        }\n      }\n    };\n  },\n  components: {\n    DatePicker: DatePicker\n  },\n  computed: {\n    isCreate: function isCreate() {\n      return !this.userToEdit;\n    },\n    maritalStatus: function maritalStatus() {\n      return [this.user.gender ? 'Не замужем' : 'Не женат', this.user.gender ? 'Замужем' : 'Женат', this.user.gender ? 'Разведена' : 'Разведен'];\n    },\n    notSamePasswords: function notSamePasswords() {\n      if (this.newPassword !== '') {\n        return this.newPassword !== this.checkedPassword;\n      } else {\n        return false;\n      }\n    }\n  },\n  methods: {\n    deactivateSelectFocus: function deactivateSelectFocus() {\n      this.selectFocus = false;\n    },\n    deactivatePositionFocus: function deactivatePositionFocus() {\n      var _this = this;\n\n      this.user.workerInfo.position = this.selectedPosition && this.positions.length && this.positions.find(function (i) {\n        return i.name.toLowerCase().startsWith(_this.selectedPosition.toLowerCase());\n      }) ? this.positions.find(function (i) {\n        return i.name.toLowerCase().startsWith(_this.selectedPosition.toLowerCase());\n      }) : {};\n      this.positionFocus = false;\n    },\n    changeUser: function changeUser() {\n      var _this2 = this;\n\n      if (this.isCreate) {\n        this.user.password = this.newPassword;\n\n        if (this.user.roles.find(function (i) {\n          return i.name === 'ROLE_ACCOUNTANT';\n        })) {\n          this.user.workerInfo = null;\n        }\n\n        this.$validator.validate().then(function (isValid) {\n          if (isValid && !_this2.notSamePasswords) {\n            _this2.$store.dispatch('auth/register', _this2.user).then(function (data) {\n              _this2.success(data);\n            }, function (error) {\n              _this2.message = error.response && error.response.data && error.response.data.message || error.message || error.toString();\n            });\n          }\n        });\n      } else {\n        UserService.changeUser(this.user.id, this.user).then(function (response) {\n          _this2.success(response.data);\n        }, function (error) {\n          _this2.message = error.response && error.response.data && error.response.data.message || error.message || error.toString();\n        });\n      }\n    }\n  },\n  mounted: function mounted() {\n    var _this3 = this;\n\n    if (!this.isCreate) {\n      UserService.getUser(this.userToEdit).then(function (response) {\n        _this3.user = response.data;\n        _this3.user.birthday = new Date(_this3.user.birthday);\n        _this3.selectedPosition = _this3.user.workerInfo.position.name;\n      }, function (error) {\n        _this3.message = error.response && error.response.data && error.response.data.message || error.message || error.toString();\n      });\n    }\n\n    UserService.getPositions().then(function (response) {\n      _this3.positions = response.data;\n    }, function (error) {\n      _this3.message = error.response && error.response.data && error.response.data.message || error.message || error.toString();\n    });\n  }\n};",{"version":3,"sources":["userEditor.vue"],"names":[],"mappings":"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","sourcesContent":["<style scoped>\r\n  input{\r\n    min-width: 300px;\r\n  }\r\n  .alert-error{\r\n    margin-left: 15px;\r\n  }\r\n</style>\r\n<template>\r\n  <div>\r\n    <div class=\"cover\" @click=\"close()\"></div>\r\n\r\n    <form class=\"absence-editor\" @submit.prevent=\"changeUser\">\r\n      <div>\r\n        {{isCreate ? 'Добавить пользователя' : 'Изменить информацию о пользователе'}}\r\n        <span class=\"material-icons close-icon\" @click=\"close()\">close</span>\r\n      </div>\r\n      <div class=\"row\">\r\n        <div class=\"column\">\r\n          <div class=\"row user-info\">Фамилия пользователя:</div>\r\n          <div class=\"row user-info\">Имя пользователя:</div>\r\n          <div class=\"row user-info\">Отчество пользователя:</div>\r\n        </div>\r\n        <div class=\"column\">\r\n          <div class=\"row\" style=\"margin: 8px 0\">\r\n            <input class=\"border-input\" v-model=\"user.lastName\" v-validate=\"'required|max:30'\" name=\"фамилия\"/>\r\n          </div>\r\n          <div class=\"row\" style=\"margin: 8px 0\">\r\n            <input class=\"border-input\" v-model=\"user.firstName\" v-validate=\"'required|max:30'\" name=\"имя\"/>\r\n          </div>\r\n          <div class=\"row\" style=\"margin: 8px 0\">\r\n            <input class=\"border-input\" v-model=\"user.patronymic\" v-validate=\"'max:30'\" name=\"отчество\"/>\r\n          </div>\r\n\r\n        </div>\r\n      </div>\r\n\r\n\r\n      <div\r\n          v-if=\"errors.has('фамилия')\"\r\n          class=\"row alert-error\"\r\n      >{{errors.first('фамилия')}}</div>\r\n      <div\r\n          v-if=\"errors.has('имя')\"\r\n          class=\"row alert-error\"\r\n      >{{errors.first('имя')}}</div>\r\n\r\n\r\n\r\n      <div class=\"separator\"></div>\r\n\r\n      <div class=\"row\">\r\n        <div class=\"column\">\r\n          <div class=\"row user-info\">Email пользователя:</div>\r\n          <div class=\"row user-info\">День рождения:</div>\r\n          <div class=\"row user-info\">Пол:</div>\r\n        </div>\r\n        <div class=\"column\">\r\n          <div class=\"row\"  style=\"margin: 8px 0;\">\r\n            <input\r\n                v-model=\"user.email\"\r\n                v-validate=\"'required|email|max:50'\"\r\n                type=\"email\"\r\n                class=\"border-input\"\r\n                name=\"email\"\r\n            />\r\n          </div>\r\n          <div class=\"row\">\r\n            <date-picker v-model=\"user.birthday\"\r\n                         style=\"outline: 0;\r\n                              width: 274px;\r\n                              border: 1px solid #dce1e6;\r\n                              border-radius: 3px;\r\n                              padding: 6px 12px;\"\r\n                         type=\"date\"\r\n                         name = \"день рождения\"\r\n                         v-validate=\"'required'\"\r\n                         format=\"DD MMMM YYYY г.\" :lang=\"lang\"\r\n                         :clearable = \"false\"\r\n                         :confirm=\"true\"\r\n                         input-class=\"date-picker\"\r\n                         placeholder=\"Выбрать\">\r\n            </date-picker>\r\n          </div>\r\n          <div class=\"row\" style=\"margin: calc(15px - 5px) 0; text-align: center;\">\r\n              <span v-bind:style=\"[user.gender ? {'background': 'none'} : {'background': 'rgb(223, 230, 237)'}]\"\r\n                    @click=\"user.gender=false;\"\r\n                    class=\"material-icons square-border-button\">\r\n                man\r\n              </span>\r\n            <div style=\"width: 100px;\">{{user.gender ? 'Женский' : 'Мужской'}}</div>\r\n            <span v-bind:style=\"[user.gender ? {'background': 'rgb(223, 230, 237)'} : {'background': 'none'}]\"\r\n                  @click=\"user.gender=true;\"\r\n                  class=\"material-icons square-border-button\">\r\n                woman\r\n              </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div\r\n          v-if=\"errors.has('email')\"\r\n          class=\"row alert-error\"\r\n      >{{errors.first('email')}}</div>\r\n\r\n      <div\r\n          v-if=\"errors.has('день рождения')\"\r\n          class=\"row alert-error\"\r\n      >{{errors.first('день рождения')}}</div>\r\n\r\n      <div class=\"separator\"></div>\r\n      <div class=\"row\" v-if=\"user.roles\">\r\n        <div class=\"user-info\">Роль:</div>\r\n        <div class=\"row\" style=\"margin: calc(15px - 5px) 0; text-align: center;\">\r\n              <span v-bind:style=\"[user.roles.find(i => i.name==='ROLE_ACCOUNTANT') ? {'background': 'rgb(223, 230, 237)'} : {'background': 'none'}]\"\r\n                    @click=\"user.roles=[{id: 1, name: 'ROLE_USER'}, {id: 2, name: 'ROLE_ACCOUNTANT'}];\"\r\n\r\n                    class=\"material-icons square-border-button\">\r\n                account_balance\r\n              </span>\r\n          <div style=\"width: 100px;\">{{user.roles.find(i => i.name==='ROLE_ACCOUNTANT') ? 'Бухгалтер' : 'Сотрудник'}}</div>\r\n          <span v-bind:style=\"[user.roles.find(i => i.name==='ROLE_ACCOUNTANT') ? {'background': 'none'} : {'background': 'rgb(223, 230, 237)'}]\"\r\n                @click=\"user.roles=[{id: 1, name: 'ROLE_USER'}];\"\r\n                class=\"material-icons square-border-button\">\r\n                school\r\n              </span>\r\n        </div>\r\n      </div>\r\n      <div v-if=\"user.workerInfo && !user.roles.find(i => i.name==='ROLE_ACCOUNTANT')\">\r\n        <div class=\"row\">\r\n          <div class=\"user-info\">Должность:</div>\r\n          <div class=\"row\"  v-click-outside=\"deactivatePositionFocus\" style=\"margin: 8px 0; position: relative\">\r\n            <div style=\"position: relative; width: 100%\">\r\n              <input v-on:focus=\"positionFocus = true\" type=\"text\" class=\"border-input\" style=\"width: 100%\" v-model=\"selectedPosition\">\r\n              <span class=\"material-icons close-icon\" @click=\"selectedPosition=''; selectedPositionId='';\" style=\"position: absolute; top:calc(50% - 10px); right:18px;\">close</span>\r\n            </div>\r\n\r\n            <div v-if=\"positionFocus && positions.length && positions.filter(i => i.name.toLowerCase().startsWith(selectedPosition.toLowerCase())).length\" class=\"input-select\">\r\n              <div v-for=\"position in positions.filter(i => i.name.toLowerCase().startsWith(selectedPosition.toLowerCase()))\" :key=\"position.id\" @click=\"selectedPosition=position.name; selectedPositionId=position.id; positionFocus=false;\">{{position.name}}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"row\">\r\n          <div class=\"user-info\">Семейное положение:</div>\r\n          <div class=\"row\">\r\n            <div v-click-outside=\"deactivateSelectFocus\" style=\"position: relative; width: fit-content; min-width: 6em; padding-right: 20px\">\r\n              <div @click=\"selectFocus=!selectFocus\" style=\"display: flex; justify-content: space-between;\">\r\n                <div style=\"margin-right: 5px\">{{maritalStatus[user.workerInfo ? (user.workerInfo.maritalStatus % 3):0]}}</div>\r\n                <span class=\"material-icons\" v-bind:style=\"{ 'padding-right': '0px', transform: 'rotate('+ (selectFocus ? '90':'0')+'deg)'}\">chevron_right</span>\r\n              </div>\r\n              <div class=\"select\" v-bind:style=\"[selectFocus ? {display:'block'} : {display: 'none'}]\">\r\n                <div @click=\"selectFocus=!selectFocus\">Placeholder</div>\r\n                <div v-for=\"(status, index) in maritalStatus\" :key=\"index\"\r\n                     @click=\"()=>{user.workerInfo.maritalStatus=index; deactivateSelectFocus();}\">\r\n                  {{status}}\r\n                </div>\r\n              </div>\r\n\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"row\">\r\n          <div class=\"user-info\">Количество детей:</div>\r\n          <div class=\"row\" style=\"padding-right: 20px\">\r\n            <div><span\r\n                style=\"display: block; background-color: rgb(223, 230, 237); border-radius: 3px; padding: 0; cursor: pointer\"\r\n                @click=\"()=>{if(user.workerInfo.children > 0) {user.workerInfo.children-=1;}}\"\r\n                class=\"material-icons unselectable\">remove</span>\r\n            </div>\r\n            <div style=\"padding: 0 10px; width: 100%; text-align: center\">{{user.workerInfo.children}}</div>\r\n            <div><span\r\n                style=\"display: block; background-color: rgb(223, 230, 237); border-radius: 3px; padding: 0; cursor: pointer\"\r\n                @click=\"()=>{if(user.workerInfo.children < 10) {user.workerInfo.children+=1;}}\"\r\n                class=\"material-icons unselectable\">add</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div v-if=\"isCreate\">\r\n        <div class=\"separator\"></div>\r\n\r\n        <div class=\"row\">\r\n          <div class=\"user-info\">Новый пароль:</div>\r\n          <input type=\"password\"\r\n                 class=\"border-input\"\r\n                 v-model=\"newPassword\" name=\"пароль\"\r\n                 v-validate=\"'required|min:6|max:40'\"/>\r\n        </div>\r\n        <div class=\"alert-error\" v-if=\"this.newPassword.includes(' ') && passwordFocus\">Пароль не может содержать пробелы</div>\r\n        <div\r\n            v-if=\"errors.has('пароль')\"\r\n            class=\"alert-error\"\r\n        >{{errors.first('пароль')}}</div>\r\n        <div\r\n            v-else-if=\"errors.has('пароль')\"\r\n            class=\"alert-error\">\r\n          {{errors.first('пароль')}}\r\n        </div>\r\n        <div class=\"row\">\r\n          <div class=\"user-info\">Повторите новый пароль:</div>\r\n          <input type=\"password\"\r\n                 class=\"border-input\"\r\n                 v-model=\"checkedPassword\"/>\r\n        </div>\r\n        <div v-if=\"notSamePasswords\" class=\"alert-error\">Пароли не совпадают</div>\r\n\r\n      </div>\r\n\r\n\r\n\r\n      <div>\r\n        <button class=\"btn btn-thin\" style=\"margin: 0\">{{isCreate ? 'Добавить пользователя' : 'Изменить'}}</button> {{message}}\r\n      </div>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport DatePicker from 'vue2-datepicker';\r\nimport 'vue2-datepicker/index.css';\r\nimport 'vue2-datepicker/locale/es/ru.js';\r\nimport UserService from \"@/services/user.service\";\r\n\r\nexport default {\r\n  name: \"userEditor\",\r\n  props: ['userToEdit', 'success', 'close'],\r\n  data() {\r\n    return {\r\n      message: '',\r\n\r\n      newPassword: '',\r\n      checkedPassword: '',\r\n      successful: false,\r\n\r\n      selectFocus: false,\r\n      positionFocus: false,\r\n\r\n      selectedPosition: '',\r\n\r\n      positions:[],\r\n\r\n      user:{\r\n        id:'',\r\n        email: '',\r\n        password: '',\r\n        firstName: '',\r\n        lastName: '',\r\n        patronymic: '',\r\n\r\n        birthday: '',\r\n        gender: false,\r\n        profilePicture: '',\r\n\r\n        workerInfo: {\r\n          position: {},\r\n          maritalStatus: 0,\r\n          children: 0,\r\n        },\r\n\r\n        roles: [\r\n          {\r\n            id: 1,\r\n            name: 'ROLE_USER'\r\n          }\r\n        ]\r\n      },\r\n\r\n      lang: {\r\n        formatLocale: {\r\n          months: ['января', 'февраля', 'марта', 'апреля', 'мая', 'июня', 'июля', 'августа', 'сентября', 'октября', 'ноября', 'декабря'],\r\n        }\r\n      }\r\n    };\r\n  },\r\n  components:{\r\n    DatePicker\r\n  },\r\n  computed:{\r\n    isCreate(){\r\n      return !(this.userToEdit)\r\n    },\r\n\r\n    maritalStatus(){\r\n      return [\r\n        this.user.gender ? 'Не замужем': 'Не женат',\r\n        this.user.gender ? 'Замужем': 'Женат',\r\n        this.user.gender ? 'Разведена': 'Разведен'\r\n      ]\r\n    },\r\n\r\n\r\n    notSamePasswords () {\r\n      if (this.newPassword !== '') {\r\n        return (this.newPassword !== this.checkedPassword)\r\n      } else {\r\n        return false\r\n      }\r\n    },\r\n  },\r\n  methods:{\r\n    deactivateSelectFocus(){\r\n      this.selectFocus=false;\r\n    },\r\n    deactivatePositionFocus(){\r\n\r\n      this.user.workerInfo.position =\r\n          this.selectedPosition && this.positions.length && this.positions.find(i => i.name.toLowerCase().startsWith(this.selectedPosition.toLowerCase()))\r\n              ? this.positions.find(i => i.name.toLowerCase().startsWith(this.selectedPosition.toLowerCase()))\r\n              : {};\r\n      this.positionFocus = false;\r\n    },\r\n\r\n    changeUser(){\r\n\r\n      if (this.isCreate){\r\n        this.user.password = this.newPassword;\r\n\r\n        if (this.user.roles.find(i => i.name==='ROLE_ACCOUNTANT')){\r\n          this.user.workerInfo = null;\r\n        }\r\n\r\n        this.$validator.validate().then(isValid => {\r\n          if (isValid && !this.notSamePasswords) {\r\n            this.$store.dispatch('auth/register', this.user).then(\r\n                data => {\r\n                  this.success(data);\r\n                },\r\n                error => {\r\n                  this.message =\r\n                      (error.response && error.response.data && error.response.data.message) ||\r\n                      error.message ||\r\n                      error.toString();\r\n                }\r\n            );\r\n          }\r\n        });\r\n      } else {\r\n        UserService.changeUser(this.user.id, this.user).then(\r\n            response => {\r\n              this.success(response.data);\r\n            },\r\n            error => {\r\n              this.message =\r\n                  (error.response && error.response.data && error.response.data.message) ||\r\n                  error.message ||\r\n                  error.toString();\r\n            }\r\n        );\r\n      }\r\n\r\n    }\r\n  },\r\n  mounted() {\r\n    if (!this.isCreate){\r\n      UserService.getUser(this.userToEdit).then(\r\n          response => {\r\n            this.user = response.data;\r\n            this.user.birthday = new Date(this.user.birthday);\r\n            this.selectedPosition = this.user.workerInfo.position.name;\r\n          },\r\n          error => {\r\n            this.message =\r\n                (error.response && error.response.data && error.response.data.message) ||\r\n                error.message ||\r\n                error.toString();\r\n          }\r\n      );\r\n\r\n    }\r\n    UserService.getPositions().then(\r\n        response => {\r\n          this.positions = response.data;\r\n        },\r\n        error => {\r\n          this.message =\r\n              (error.response && error.response.data && error.response.data.message) ||\r\n              error.message ||\r\n              error.toString();\r\n        }\r\n    );\r\n  }\r\n}\r\n</script>\r\n\r\n"],"sourceRoot":"src/views/components"}]}